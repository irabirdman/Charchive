[phases.setup]
cmds = [
  "mkdir -p /tmp/.next-cache",
]

[phases.install]
cmds = [
  "npm ci --production=false || (rm -rf node_modules/.cache && npm ci --production=false)",
]

[phases.build]
cmds = [
  "npm run build",
]

[variables]
NPM_CONFIG_CACHE = "/tmp/.npm"
NODE_OPTIONS = "--max-old-space-size=4096"
NEXT_TELEMETRY_DISABLED = "1"

[start]
cmd = "npm start"
